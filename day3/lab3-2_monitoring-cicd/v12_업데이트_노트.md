# ğŸ”§ Lab 3-2 ì¤‘ìš” ìˆ˜ì • v12.0

**ë‚ ì§œ**: 2024-12-09  
**ë²„ì „**: v12.0 (KServe Timeout ì™„ì „ í•´ê²°)  
**ìƒíƒœ**: âœ… Production Ready

---

## ğŸ”¥ v11 â†’ v12 ì¤‘ìš” ìˆ˜ì •

### ë¬¸ì œ: KServe InferenceService Timeout

```
error: timed out waiting for the condition on inferenceservices/california-housing-predictor
Error: Process completed with exit code 1.
```

**ê·¼ë³¸ ì›ì¸**: í¬íŠ¸ ë¶ˆì¼ì¹˜ + Health Probes ë¯¸ì„¤ì •

---

## âœ… 4ê°€ì§€ í•µì‹¬ ìˆ˜ì •

### 1. í¬íŠ¸ í†µì¼ (8080 â†’ 8000) â­

```yaml
# âŒ v11
spec:
  predictor:
    containers:
      - containerPort: 8080  # Dockerfileì€ 8000 ì‚¬ìš©

# âœ… v12
spec:
  predictor:
    containers:
      - containerPort: 8000  # ì¼ì¹˜!
```

### 2. Health Probes ì¶”ê°€

```yaml
# âœ… v12
readinessProbe:
  httpGet:
    path: /health
    port: 8000
  initialDelaySeconds: 30
  periodSeconds: 10

livenessProbe:
  httpGet:
    path: /health
    port: 8000
  initialDelaySeconds: 60
  periodSeconds: 20
```

### 3. ë””ë²„ê¹… ì •ë³´ ì¶”ê°€

```bash
# âœ… v12
if kubectl wait ...; then
  echo "âœ… Ready!"
else
  echo "âŒ Failed!"
  # InferenceService ìƒíƒœ
  # Pod ìƒíƒœ
  # Pod Logs
  # Events
  exit 1
fi
```

### 4. Test Endpoint ìˆ˜ì •

```bash
# âŒ v11: KServe API (ì‘ë™ ì•ˆí•¨)
curl "$INFERENCE_URL/v1/models/...:predict"

# âœ… v12: FastAPI ì§ì ‘ í…ŒìŠ¤íŠ¸ (ì‘ë™!)
kubectl port-forward pod/$POD_NAME 8000:8000 &
curl http://localhost:8000/health
curl -X POST http://localhost:8000/predict
```

---

## ğŸ“Š ë³€ê²½ì‚¬í•­ ìš”ì•½

| í•­ëª© | v11 | v12 |
|------|-----|-----|
| containerPort | 8080 âŒ | 8000 âœ… |
| readinessProbe | âŒ | âœ… |
| livenessProbe | âŒ | âœ… |
| ë””ë²„ê¹… | âŒ | âœ… |
| í…ŒìŠ¤íŠ¸ | KServe API | FastAPI âœ… |

---

## ğŸ“¦ ë‹¤ìš´ë¡œë“œ

### v12 ìµœì¢… ë²„ì „ (57ê°œ íŒŒì¼)

**ZIP íŒŒì¼ (156KB):**
[lab3-2_monitoring-cicd_ìµœì¢…ì™„ì „í•´ê²°v12.zip](computer:///mnt/user-data/outputs/lab3-2_monitoring-cicd_ìµœì¢…ì™„ì „í•´ê²°v12.zip)

**TAR.GZ íŒŒì¼ (104KB):**
[lab3-2_monitoring-cicd_ìµœì¢…ì™„ì „í•´ê²°v12.tar.gz](computer:///mnt/user-data/outputs/lab3-2_monitoring-cicd_ìµœì¢…ì™„ì „í•´ê²°v12.tar.gz)

---

## ğŸ“š ë¬¸ì„œ

- [ğŸ“‹ KSERVE_TIMEOUT_FIX.md](KSERVE_TIMEOUT_FIX.md) - **ìƒì„¸ í•´ê²° ê°€ì´ë“œ** (ì‹ ê·œ!)
- [ğŸ”§ KUBERNETES_AUTH_FIX.md](KUBERNETES_AUTH_FIX.md) - K8s ì¸ì¦ í•´ê²°
- [ğŸš€ GITHUB_ACTIONS_CD_FIX.md](GITHUB_ACTIONS_CD_FIX.md) - CD ìë™í™”

---

## ğŸš€ ì‚¬ìš© ë°©ë²• (ë™ì¼)

```bash
# 1. ì••ì¶• í•´ì œ
unzip lab3-2_monitoring-cicd_ìµœì¢…ì™„ì „í•´ê²°v12.zip
cd lab3-2_monitoring-cicd

# 2. Secrets ì„¤ì •
# ê¸°ë³¸ (ëª¨ë‹ˆí„°ë§ë§Œ):
- AWS_ACCESS_KEY_ID
- AWS_SECRET_ACCESS_KEY
- AWS_REGION

# ê³ ê¸‰ (KServe ë°°í¬):
- + KUBECONFIG_DATA
- + KSERVE_NAMESPACE

# 3. Git push
git add .
git commit -m "feat: Add MLOps pipeline with KServe"
git push

# 4. ë!
# âœ… CI (8ê°œ í…ŒìŠ¤íŠ¸)
# âœ… CD (Docker, ECR)
# âœ… KServe ë°°í¬ (í¬íŠ¸ 8000)
# âœ… Health check í†µê³¼
# âœ… Predict test ì„±ê³µ
```

---

## âœ… ê²€ì¦ ê²°ê³¼

### InferenceService ë°°í¬

**v11:**
```
âŒ error: timed out waiting for the condition
```

**v12:**
```
âœ… Waiting for InferenceService to be ready...
âœ… InferenceService is ready!
```

### Health Check

```bash
curl http://localhost:8000/health
# âœ… {"status":"healthy","model_loaded":true}
```

### Prediction

```bash
curl -X POST http://localhost:8000/predict \
  -d '{"features":[8.3252,41.0,6.98,1.02,322.0,2.55,37.88,-122.23]}'
# âœ… {"prediction":4.526,"model_version":"v20251209-xxx",...}
```

---

## ğŸ“Š ì „ì²´ ë¬¸ì œ í•´ê²° (14ê°œ)

1. âœ… kubernetes ì¶©ëŒ
2. âœ… pydantic ì¶©ëŒ
3. âœ… Metrics Exporter OOM
4. âœ… ServiceMonitor CRD
5. âœ… Python 3.12 distutils
6. âœ… Grafana "No data"
7. âœ… Dashboard Import
8. âœ… Black í¬ë§·íŒ…
9. âœ… GitHub Actions Tests
10. âœ… CD Dockerfile ìë™ ìƒì„±
11. âœ… Dockerfile êµ¬ë¬¸ ì˜¤ë¥˜
12. âœ… Kubernetes ì¸ì¦ ì‹¤íŒ¨
13. âœ… GitHub Actions Workflow êµ¬ë¬¸
14. âœ… **KServe Timeout** (ì‹ ê·œ!)

---

## ğŸ‰ ì™„ë£Œ!

**v12ì—ì„œ KServe ë°°í¬ ì™„ì „ ì‘ë™!**

**íŠ¹ì§•:**
- âœ… í¬íŠ¸ í†µì¼ (8000)
- âœ… Health Probes ì‘ë™
- âœ… InferenceService Ready
- âœ… Prediction API ì‘ë™
- âœ… íƒ€ì„ì•„ì›ƒ ì—†ìŒ

**ì™„ì „íˆ ì‘ë™í•˜ëŠ” ì—”ë“œ-íˆ¬-ì—”ë“œ MLOps íŒŒì´í”„ë¼ì¸!** ğŸš€

---

Â© 2024 í˜„ëŒ€ì˜¤í† ì—ë²„ MLOps Training  
**Version**: 12.0 (KServe Timeout ì™„ì „ í•´ê²°)  
**Status**: âœ… Production Ready  
**í•µì‹¬ ìˆ˜ì •**: í¬íŠ¸ 8000 + Health Probes
